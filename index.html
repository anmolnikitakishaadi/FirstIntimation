<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Anmol & Nikita | The Royal Wedding</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Pinyon+Script&family=Marcellus&family=Lato:wght@300;400;700&display=swap" rel="stylesheet">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>

    <style>
        :root {
            --bg-cream: #f2ecdc; 
            --glass-bg: rgba(255, 255, 255, 0.6);
            --glass-border: rgba(255, 255, 255, 0.8);
            --gold: #c5a059;
            --text-dark: #2a2a2a;
            --text-accent: #9e4f5e; 
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Lato', sans-serif;
            background-color: var(--bg-cream);
            color: var(--text-dark);
            min-height: 100vh;
            overflow-x: hidden;
            background-image: 
                linear-gradient(45deg, rgba(200, 160, 100, 0.05) 25%, transparent 25%, transparent 75%, rgba(200, 160, 100, 0.05) 75%, rgba(200, 160, 100, 0.05)),
                linear-gradient(45deg, rgba(200, 160, 100, 0.05) 25%, transparent 25%, transparent 75%, rgba(200, 160, 100, 0.05) 75%, rgba(200, 160, 100, 0.05));
            background-size: 40px 40px;
            background-position: 0 0, 20px 20px;
            font-size: 16px;
        }

        /* --- LOADING SCREEN --- */
        #loader {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: var(--bg-cream); z-index: 9999;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
        }
        .loader-logo {
            width: 150px; margin-bottom: 30px;
            animation: pulse 2s infinite;
        }
        .loader-bar-container {
            width: 80%; max-width: 300px; height: 3px; background: rgba(0,0,0,0.05);
            border-radius: 10px; position: relative; overflow: visible;
        }
        .loader-progress {
            width: 0%; height: 100%; background: var(--gold); border-radius: 10px;
            position: relative;
        }
        .loader-icon {
            position: absolute; right: -12px; top: -20px; font-size: 1.2rem;
        }
        .loading-text {
            margin-top: 15px; font-family: 'Marcellus', serif; font-size: 0.9rem;
            color: var(--text-accent); letter-spacing: 2px;
        }

        /* --- MAIN CONTENT --- */
        .container {
            max-width: 900px; margin: 0 auto; position: relative; z-index: 2;
            padding: 20px; padding-bottom: 100px;
        }

        /* Typography */
        h1 {
            font-family: 'Pinyon Script', cursive; color: var(--text-accent);
            font-size: 6rem; text-align: center; line-height: 1.2; margin: 10px 0 40px;
            text-shadow: 2px 2px 0px rgba(255,255,255,0.5);
            transform: rotate(0deg); 
            font-weight: 400;
        }
        h2 {
            font-family: 'Marcellus', serif; color: var(--gold); text-align: center;
            font-size: 1.8rem; letter-spacing: 2px; margin-bottom: 35px; text-transform: uppercase;
        }
        h3 {
            font-family: 'Marcellus', serif; color: var(--text-dark); font-size: 1.3rem;
            margin-bottom: 12px; border-bottom: 2px solid rgba(197, 160, 89, 0.3);
            padding-bottom: 8px; display: inline-block;
        }

        /* Glass Cards */
        .glass-card {
            background: var(--glass-bg); 
            backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border); border-radius: 20px; padding: 40px;
            margin-bottom: 50px; box-shadow: 0 20px 50px rgba(0,0,0,0.05);
            overflow: hidden; 
        }

        .main-logo {
            width: 100%; max-width: 600px;
            height: auto; margin: 0 auto 10px; display: block;
            border: none !important;
            outline: none !important;
            box-shadow: none !important;
            border-radius: 0 !important;
            background: transparent !important;
        }

        .header-subtitle {
            font-family: 'Marcellus'; font-size: 1rem; font-weight: 700;
            letter-spacing: 3px; margin-bottom: 5px; color: var(--text-dark); text-transform: uppercase;
        }
        .divider {
            text-align: center; font-size: 2.5rem; color: var(--gold);
            margin: 40px 0; opacity: 0.8; font-family: 'Pinyon Script';
        }

        /* Family Grid */
        .family-grid { display: grid; grid-template-columns: 1fr; gap: 30px; text-align: center; }
        .family-role {
            font-size: 0.85rem; text-transform: uppercase; color: var(--text-accent);
            font-weight: 700; margin-bottom: 5px; letter-spacing: 1px; font-family: 'Marcellus';
        }
        .family-names { font-size: 1.1rem; line-height: 1.5; }

        /* Event Cards */
        .event-card {
            display: flex; flex-direction: column;
            background: rgba(255,255,255,0.8);
            border-radius: 20px; overflow: hidden; margin-bottom: 50px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.05); 
        }
        .event-image-container {
            width: 100%; height: 380px;
            position: relative; overflow: hidden;
        }
        .event-image {
            width: 100%; height: 100%; 
            object-fit: cover; object-position: top center;
            transition: transform 1.5s ease;
        }
        
        /* Event Gradients */
        #mayra-card .event-image-container { background: linear-gradient(135deg, #ff9a44, #fc6076); }
        #sangeet-card .event-image-container { background: linear-gradient(135deg, #232526, #414345); }
        #haldi-card .event-image-container { background: linear-gradient(135deg, #fce38a, #f38181, #a8e063); }
        #wedding-card .event-image-container { background: linear-gradient(135deg, #ba1c1c, #d4af37); }

        .event-details {
            padding: 40px; text-align: center; display: flex; flex-direction: column; justify-content: center;
        }
        .event-date {
            font-family: 'Marcellus', serif; font-weight: 700; color: var(--text-accent);
            background: #fff; padding: 8px 20px; border-radius: 50px;
            display: inline-block; margin: 0 auto 15px; box-shadow: 0 5px 15px rgba(0,0,0,0.05); font-size: 0.9rem;
        }
        .event-title {
            font-family: 'Pinyon Script', cursive; font-size: 3.5rem; color: var(--text-dark);
            margin-bottom: 10px; line-height: 1; padding: 10px 0;
        }
        .dress-code-box {
            margin-top: 20px; padding: 20px; border: 1px dashed var(--gold);
            border-radius: 10px; background: rgba(242, 236, 220, 0.4); font-size: 1.1rem;
        }
        .dress-code-label {
             font-family: 'Marcellus', serif; font-weight: 700; color: var(--gold); margin-bottom: 8px; display: block; text-transform: uppercase; letter-spacing: 1px;
        }

        /* Venue Section */
        #venue-card { padding: 0 !important; border: none; overflow: hidden; }
        
        .venue-cover-img {
            width: 100%; height: 300px;
            object-fit: cover; object-position: center bottom;
            display: block;
        }
        .venue-content-wrapper { padding: 40px; text-align: center; background: var(--glass-bg); backdrop-filter: blur(20px); }

        .map-container {
            position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; border-radius: 15px;
            border: 2px solid var(--gold); margin: 30px 0; box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        .map-container iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: 0; }

        /* Buttons */
        .btn-rsvp {
            display: inline-block; background: var(--text-accent); color: #fff;
            padding: 18px 50px; border-radius: 50px; text-decoration: none;
            font-family: 'Marcellus', serif; font-weight: 700; letter-spacing: 2px;
            margin-top: 25px; transition: all 0.3s; font-size: 1.1rem;
            box-shadow: 0 10px 30px rgba(158, 79, 94, 0.4); border: none; cursor: pointer; text-transform: uppercase;
        }
        .btn-rsvp:hover {
            transform: translateY(-5px); background: #7a3b47; box-shadow: 0 15px 40px rgba(158, 79, 94, 0.6);
        }

        /* Modal */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.7); z-index: 10000;
            display: flex; justify-content: center; align-items: center;
            opacity: 0; pointer-events: none; transition: opacity 0.3s ease;
        }
        .modal-overlay.active { opacity: 1; pointer-events: all; }
        .modal-content {
            background: #fff; 
            border: 1px solid var(--gold); border-radius: 20px; padding: 40px; width: 90%; max-width: 450px;
            position: relative; text-align: center; 
        }
        .close-modal { position: absolute; top: 15px; right: 20px; font-size: 2rem; color: var(--text-dark); cursor: pointer; }
        .form-input {
            width: 100%; padding: 15px; border: 1px solid #ccc;
            border-radius: 5px; background: #f9f9f9;
            font-family: 'Lato', sans-serif; font-size: 1rem; outline: none; margin-bottom: 15px;
        }
        .checkbox-group { display: flex; align-items: center; justify-content: center; margin: 20px 0; }
        .checkbox-group input { width: 20px; height: 20px; margin-right: 10px; accent-color: var(--gold); }
        
        #guest-count-wrapper {
            display: block; 
            margin-bottom: 20px;
            text-align: left;
            animation: fadeIn 0.3s ease-in-out;
        }

        /* NEW MUSIC BUTTON */
        .music-control {
            position: fixed; bottom: 20px; right: 20px; z-index: 9998;
            width: 50px; height: 50px; border-radius: 50%;
            background: var(--text-accent); color: white;
            display: flex; justify-content: center; align-items: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            cursor: pointer; transition: transform 0.3s ease;
            font-size: 1.2rem; border: 2px solid #fff;
        }
        .music-control:hover { transform: scale(1.1); }
        .music-waves {
            display: inline-block; width: 3px; height: 15px;
            background: #fff; margin: 0 2px;
            animation: none;
        }
        .playing .music-waves { animation: sound 1s infinite ease-in-out; }
        .playing .music-waves:nth-child(2) { animation-delay: 0.2s; }
        .playing .music-waves:nth-child(3) { animation-delay: 0.4s; }

        /* PLAY TOOLTIP */
        .play-tooltip {
            position: fixed; bottom: 80px; right: 20px; z-index: 9998;
            background: #fff; padding: 10px 15px; border-radius: 10px;
            font-family: 'Marcellus'; font-size: 0.8rem;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            display: none;
        }
        
        @keyframes sound {
            0% { height: 5px; } 50% { height: 20px; } 100% { height: 5px; }
        }
        
        @keyframes fadeIn { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }

        footer { text-align: center; font-size: 0.9rem; color: rgba(0,0,0,0.5); margin-top: 60px; font-family: 'Marcellus'; margin-bottom: 20px;}

        @media (min-width: 768px) {
            .container { max-width: 1000px; }
            h1 { font-size: 8rem; } 
            .family-grid { grid-template-columns: 1fr 1fr; gap: 60px; }
            .event-card { flex-direction: row; text-align: left; align-items: stretch; }
            .event-card:nth-child(even) { flex-direction: row-reverse; }
            .event-image-container { width: 45%; height: auto; min-height: 500px; } 
            .event-details { width: 55%; padding: 60px; text-align: left; align-items: flex-start; }
            .venue-cover-img { height: 400px; }
        }
    </style>
</head>
<body>

    <div id="play-tooltip" class="play-tooltip">Tap here for Music üéµ</div>
    <button id="music-toggle" class="music-control">
        <div class="music-waves"></div>
        <div class="music-waves"></div>
        <div class="music-waves"></div>
    </button>
    
    <audio id="wedding-audio" loop>
        <source src="mysong.mp3.mp3" type="audio/mp3">
        Your browser does not support the audio element.
    </audio>

    <div id="loader">
        <img src="https://i.postimg.cc/8c3Gv8MD/Logo-Final-(I-GUESS).jpg" class="loader-logo" alt="Logo">
        <div class="loader-bar-container">
            <div class="loader-progress" id="progress-bar">
                <div class="loader-icon" id="loader-icon">üì∑</div>
            </div>
        </div>
        <p class="loading-text">Loading The Celebration...</p>
    </div>

    <div class="container" id="main-content">
        
        <div class="glass-card header-section" style="text-align: center; padding-top: 50px; background: transparent; border: none; box-shadow: none;">
            <div class="header-subtitle">|| Om Shree Ganeshay Namah ||</div>
            <div class="header-subtitle">|| Rani satyeh namah ||</div>
            
            <img src="https://i.postimg.cc/8c3Gv8MD/Logo-Final-(I-GUESS).jpg" class="main-logo" alt="Anmol Nikita Logo">
            
            <h2 class="gsap-fade-static">We Invite You To The Royal Union Of</h2>
            <h1 class="gsap-scale-static">Anmol & Nikita</h1>
            <div class="divider gsap-fade-static">~ ‚úª ~</div>
            
            <div class="family-grid gsap-fade-static">
                <div>
                    <h3>Groom's Family</h3>
                    <div style="margin-bottom: 20px;">
                        <div class="family-role">Grandparents</div>
                        <div class="family-names">Shri Yugal Kishore Jalan &<br>Late Chandrakanta Jalan</div>
                    </div>
                    <div>
                        <div class="family-role">Parents</div>
                        <div class="family-names">Shri Sunil Kumar Jalan &<br>Smt. Anita Jalan</div>
                    </div>
                </div>
                <div>
                    <h3>Bride's Family</h3>
                    <div style="margin-bottom: 20px;">
                        <div class="family-role">Grandparents</div>
                        <div class="family-names">Late Nanuram Gupta &<br>Late Harpyari Devi</div>
                    </div>
                    <div>
                        <div class="family-role">Parents</div>
                        <div class="family-names">Shri Ramesh Chandra Gupta &<br>Smt. Sabita Gupta</div> </div>
                </div>
            </div>
        </div>

        <div style="margin-top: 20px;">
            <h2 class="gsap-scroll-fade">Wedding Itinerary</h2>
            
            <div class="event-card" id="mayra-card">
                <div class="event-image-container">
                    <img src="https://i.postimg.cc/T11MTnCw/mayra.png" class="event-image" alt="Mayra">
                </div>
                <div class="event-details">
                    <div class="event-date">12 FEB 2026 | 11:30 AM</div>
                    <div class="event-title">Mayra</div>
                    <div class="dress-code-box">
                        <span class="dress-code-label">Theme: Royal Rajasthani Hues</span>
                        <strong>Mens:</strong> Traditional Wear<br>
                        <strong>Women:</strong> Bandhej / Gharchola
                    </div>
                </div>
            </div>

            <div class="event-card" id="sangeet-card">
                <div class="event-image-container">
                    <img src="https://i.postimg.cc/Y00KtQbS/Sangeet.png" class="event-image" alt="Sangeet">
                </div>
                <div class="event-details">
                    <div class="event-date">12 FEB 2026 | 05:30 PM</div>
                    <div class="event-title">Tilak & Sangeet</div>
                    <div class="dress-code-box">
                        <span class="dress-code-label">Theme: Written in the Stars</span>
                        Shine Bright, Dance All Night.<br>
                        Sparkle & Glam.
                    </div>
                </div>
            </div>

            <div class="event-card" id="haldi-card">
                <div class="event-image-container">
                    <img src="https://i.postimg.cc/XqqSn9QN/haldi.png" class="event-image" alt="Haldi">
                </div>
                <div class="event-details">
                    <div class="event-date">13 FEB 2026 | 10:00 AM Onwards</div>
                    <div class="event-title">Haldi & Fun</div>
                    <div class="dress-code-box">
                        <span class="dress-code-label">Theme: Vibrant & Multi-Color</span>
                        Hues of Happiness.<br>
                        Colorful & Fun Attire.
                    </div>
                </div>
            </div>

            <div class="event-card" id="wedding-card">
                <div class="event-image-container">
                    <img src="https://i.postimg.cc/Bbb9J2Mt/wedding.png" class="event-image" alt="Wedding">
                </div>
                <div class="event-details">
                    <div class="event-date">13 FEB 2026</div>
                    
                    <div class="event-title">The Wedding</div>
                    
                    <div style="margin-bottom: 20px; font-family: 'Marcellus', serif; color: var(--text-dark); font-size: 1.1rem; line-height: 1.8;">
                        Korat - 05:00 PM<br>
                        Baraat - 05:30 PM<br>
                        Varmala & Reception - 06:30 PM Onwards
                    </div>

                    <div class="dress-code-box">
                        <span class="dress-code-label">Theme: Regal & Radiant</span>
                        Royal Traditional Indian Wear.<br>
                        Enamoured Ever After.
                    </div>
                </div>
            </div>

        </div>

        <div class="glass-card" id="venue-card">
            <img src="https://i.postimg.cc/m2LzT72P/cartoon-venue.png" class="venue-cover-img" alt="Banabithi Resort">
            
            <div class="venue-content-wrapper">
                <h2>The Venue</h2>
                <div style="font-size: 3rem; margin-bottom: 20px; font-family: 'Pinyon Script'; color: var(--text-dark); line-height: 1;">Banabithi Resort</div>
                
                <div class="map-container">
                    <iframe src="https://maps.google.com/maps?q=Banabithi%20Resort%20Ghatakpukur&t=&z=13&ie=UTF8&iwloc=&output=embed" width="600" height="450" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
                </div>

                <div class="divider">~ ‚úª ~</div>
                
                <p style="margin-bottom: 25px; font-size: 1.1rem;">Please grace us with your presence.</p>
                <button id="open-rsvp-btn" class="btn-rsvp">Confirm Your Presence</button>

                <div style="margin-top: 40px; border-top: 1px dashed var(--gold); padding-top: 30px;">
                    <h3 style="border: none; font-size: 2rem; margin-bottom: 15px; font-family: 'Marcellus'; color: var(--text-accent);">‡§ú‡§æ‡§≤‡§æ‡§® ‡§™‡§∞‡§ø‡§µ‡§æ‡§∞</h3>
                    <div style="font-family: 'Lato'; font-size: 1.2rem; line-height: 1.6;">
                        <a href="tel:+918888994444" style="text-decoration: none; color: var(--text-dark); display: block; margin-bottom: 8px; transition: color 0.3s;">üìû +91 88889 94444</a>
                        <a href="tel:+918888766666" style="text-decoration: none; color: var(--text-dark); display: block; transition: color 0.3s;">üìû +91 88887 66666</a>
                    </div>
                </div>
            </div>
        </div>

        <footer>
            Made with ‚ù§Ô∏è for Anmol & Nikita's Big Day
        </footer>
    </div>

    <div class="modal-overlay" id="rsvp-modal">
        <div class="modal-content">
            <span class="close-modal" id="close-modal-btn">√ó</span>
            <h2 style="font-size: 1.5rem; margin-bottom: 20px;">RSVP Confirmation</h2>
            
            <form id="rsvp-form" name="submit-to-google-sheet">
                <input type="text" name="name" class="form-input" placeholder="Full Name" required>
                <input type="tel" name="contact" class="form-input" placeholder="Contact Number (WhatsApp)" required>
                
                <div class="checkbox-group">
                    <input type="checkbox" name="coming" id="coming-check" value="Yes" checked onchange="toggleGuestField()">
                    <label for="coming-check" style="font-family: 'Marcellus';">YES, I AM COMING! üéâ</label>
                </div>
                
                <div id="guest-count-wrapper">
                    <input type="text" name="guests" class="form-input" placeholder="Total Number of People (e.g. 2 Adults)">
                </div>

                <button type="submit" class="btn-rsvp" id="submit-btn" style="width: 100%; margin-top: 10px;">Submit RSVP</button>
            </form>
            <div id="rsvp-feedback" style="display:none; color: green; margin-top: 20px; font-weight: bold;">Thank you! See you there!</div>
        </div>
    </div>

    <script>
        // --- 1. CONFIGURATION ---
        const scriptURL = 'https://script.google.com/macros/s/AKfycbyrKEgx5KfCI-2h6SuKcTMtXrBP_FEbxhXYneO8IJjez48GU0xZ4POeNb9royyNSVnt/exec'; 

        // --- 2. GUEST FIELD TOGGLE ---
        function toggleGuestField() {
            const checkbox = document.getElementById('coming-check');
            const guestWrapper = document.getElementById('guest-count-wrapper');
            if(checkbox.checked) {
                guestWrapper.style.display = 'block';
                gsap.fromTo(guestWrapper, {opacity: 0, y: -10}, {opacity: 1, y: 0, duration: 0.3});
            } else {
                guestWrapper.style.display = 'none';
            }
        }

        // --- 3. LOADER & GSAP INIT ---
        window.addEventListener("load", () => {
            const icons = ['üì∑', 'üçï', 'üèãÔ∏è', 'üíÉ', 'üèçÔ∏è', 'üí°', 'üìö'];
            const loaderIcon = document.getElementById('loader-icon');
            const progressBar = document.querySelector('.loader-progress');
            const loader = document.getElementById('loader');
            
            let width = 0;
            let iconIndex = 0;

            const interval = setInterval(() => {
                if (width >= 100) {
                    clearInterval(interval);
                    gsap.to(loader, { opacity: 0, duration: 0.5, onComplete: () => {
                        loader.style.display = 'none';
                        initAnimations();
                    }});
                } else {
                    width += 2; 
                    progressBar.style.width = width + '%';
                    if (width % 14 === 0) { 
                        iconIndex = (iconIndex + 1) % icons.length;
                        loaderIcon.textContent = icons[iconIndex];
                    }
                }
            }, 30);
        });

        // --- 4. ANIMATIONS ---
        function initAnimations() {
            gsap.registerPlugin(ScrollTrigger);

            gsap.set(".gsap-fade-static", { y: 30, opacity: 0 });
            gsap.set(".gsap-scale-static", { scale: 0.8, opacity: 0 });
            gsap.set(".event-card", { y: 100, opacity: 0 });
            gsap.set("#venue-card", { y: 50, opacity: 0 });

            gsap.from(".main-logo", { duration: 1.5, y: -50, opacity: 0, ease: "power3.out" });
            gsap.to(".gsap-fade-static", { duration: 1, y: 0, opacity: 1, stagger: 0.2, delay: 0.5 });
            gsap.to(".gsap-scale-static", { duration: 1.2, scale: 1, opacity: 1, ease: "back.out(1.7)", delay: 0.8 });
            
            gsap.utils.toArray('.event-card').forEach((card, i) => {
                gsap.to(card, {
                    scrollTrigger: {
                        trigger: card,
                        start: "top 85%",
                        end: "top 50%",
                        toggleActions: "play none none reverse"
                    },
                    y: 0, opacity: 1, duration: 1, ease: "power3.out"
                });
                
                const img = card.querySelector('.event-image');
                gsap.to(img, {
                    yPercent: 15,
                    ease: "none",
                    scrollTrigger: {
                        trigger: card,
                        start: "top bottom",
                        end: "bottom top",
                        scrub: true
                    }
                });
            });

            gsap.to("#venue-card", {
                scrollTrigger: { trigger: "#venue-card", start: "top 85%" },
                y: 0, opacity: 1, duration: 1
            });
        }

        // --- 5. MUSIC PLAYER LOGIC ---
        const musicBtn = document.getElementById('music-toggle');
        const audio = document.getElementById('wedding-audio');
        const tooltip = document.getElementById('play-tooltip');
        let isPlaying = false;

        function toggleMusic() {
             if (isPlaying) {
                audio.pause();
                musicBtn.classList.remove('playing');
                musicBtn.style.opacity = "0.7";
                isPlaying = false;
            } else {
                audio.play().then(() => {
                    musicBtn.classList.add('playing');
                    musicBtn.style.opacity = "1";
                    tooltip.style.display = "none"; 
                    isPlaying = true;
                }).catch(e => {
                    console.log("Audio play failed: ", e);
                    tooltip.style.display = "block";
                    tooltip.textContent = "Click to Start Music üéµ";
                });
            }
        }

        musicBtn.addEventListener('click', toggleMusic);

        // AGGRESSIVE AUTOPLAY WORKAROUND
        // This attempts to play music on the very first touch or scroll event
        function tryAutoPlay() {
            if(!isPlaying) {
                audio.play().then(() => {
                    isPlaying = true;
                    musicBtn.classList.add('playing');
                    tooltip.style.display = "none";
                    document.removeEventListener('click', tryAutoPlay);
                    document.removeEventListener('scroll', tryAutoPlay);
                    document.removeEventListener('touchstart', tryAutoPlay); // Added for mobile
                }).catch(e => {
                    // Autoplay blocked by browser
                });
            }
        }

        document.addEventListener('click', tryAutoPlay);
        document.addEventListener('scroll', tryAutoPlay);
        document.addEventListener('touchstart', tryAutoPlay); // Added for mobile

        // --- 6. FORM HANDLER ---
        const form = document.forms['submit-to-google-sheet'];
        const modal = document.getElementById('rsvp-modal');
        const openBtn = document.getElementById('open-rsvp-btn');
        const closeBtn = document.getElementById('close-modal-btn');
        const feedback = document.getElementById('rsvp-feedback');
        const submitBtn = document.getElementById('submit-btn');

        openBtn.addEventListener('click', () => { modal.classList.add('active'); });
        closeBtn.addEventListener('click', () => { modal.classList.remove('active'); });
        modal.addEventListener('click', (e) => { if (e.target === modal) modal.classList.remove('active'); });

        form.addEventListener('submit', e => {
            e.preventDefault();
            submitBtn.disabled = true;
            submitBtn.innerHTML = "Sending...";

            const formData = new FormData(form);
            const data = {};
            formData.forEach((value, key) => data[key] = value);
            
            if(!document.getElementById('coming-check').checked) {
                data['coming'] = "No";
                data['guests'] = "0";
            } else {
                if(!data['guests']) data['guests'] = "1";
            }

            fetch(scriptURL, { method: 'POST', body: JSON.stringify(data) })
                .then(response => {
                    form.style.display = 'none';
                    feedback.style.display = 'block';
                    setTimeout(() => {
                        modal.classList.remove('active');
                        setTimeout(() => {
                            form.reset();
                            form.style.display = 'block';
                            feedback.style.display = 'none';
                            submitBtn.disabled = false;
                            submitBtn.innerHTML = "Submit RSVP";
                            document.getElementById('guest-count-wrapper').style.display = 'block';
                        }, 500);
                    }, 2000);
                })
                .catch(error => {
                    console.error('Error!', error.message);
                    alert("Something went wrong. Please try again.");
                    submitBtn.disabled = false;
                    submitBtn.innerHTML = "Submit RSVP";
                });
        });
    </script>
</body>
</html>
